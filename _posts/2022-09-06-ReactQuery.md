---

layout: post

title: 22 / 09 / 06 My TIL [React Query]

subtitle: TIL

categories: coding

tags: [React, react-query]

---
# React-query


<aside>
π’΅ Server μƒνƒλ¥Ό κ΄€λ¦¬ν•λ” react-queryμ— λ€ν•΄ μ•μ•„λ³΄μ.

</aside>

## Client State Vs Server State

---

react-query λ¥Ό μ•μ•„λ³΄κΈ°μ— μ•μ„ μ„λ²„μƒνƒκ°€ λ¬΄μ—‡μΈμ§€μ— λ€ν•΄ λ¨Όμ € μ•μ•„λ³Ό ν•„μ”κ°€ μλ‹¤.

### Client State

- Client μƒνƒλ” μ›Ή λΈλΌμ°μ € μ„Έμ…κ³Ό κ΄€λ ¨λ λ¨λ“  μ •λ³΄λ¥Ό μλ―Έν•λ‹¤.
- ν…λ§ λ³€κ²½, UI λ³€κ²½ λ“± μ„λ²„μ—μ„ μΌμ–΄λ‚λ” μΌκ³Ό κ΄€λ ¨μ΄ μ—†λ” μƒνƒλ¥Ό λ»ν•λ‹¤.

 

### Server State

- Server μƒνƒλ” μ„λ²„μ— μ €μ¥λμ§€λ§ ν΄λΌμ΄μ–ΈνΈλ¥Ό λ‚νƒ€λ‚΄λ”λ° ν•„μ”ν• λ°μ΄ν„°λ¥Ό μλ―Έν•λ‹¤.
- DBμ— μ €μ¥λ  λ°μ΄ν„°, μ΄λ―Έ μ €μ¥λμ–΄μλ” λ°μ΄ν„° μ²λΌ μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈμ— ν‘μ‹ν•  μ μλ„λ΅ μ €μ¥λ λ°μ΄ν„°λ¥Ό λ»ν•λ‹¤.

κ°κ°μ μƒνƒκ°€ μλ―Έν•λ” λ°”κ°€ λ‹¤λ¥΄λ‹¨κ±΄ μ•κ² λ”λ° μ™ κµ³μ΄κµ³μ΄ react-queryλ¥Ό μ‚¬μ©ν•λ” κ±ΈκΉ?

## Why?

---

react-queryλ” ν΄λΌμ΄μ–ΈνΈμ—μ„ μ„λ²„λ°μ΄ν„° μΊμ‹μ κ΄€λ¦¬λ¥Ό κ°€λ¥μΌ€ν•λ” λΌμ΄λΈλ¬λ¦¬μ΄λ‹¤. μ΄λ¥Ό ν†µν•΄ React Clientμ—μ„ μ„λ²„ λ°μ΄ν„°κ°€ ν•„μ”ν•  λ• ν”ν μ‚¬μ©ν•λ” `fetch` λ‚ `axios` λ¥Ό λ°”λ΅ μ‚¬μ©ν•μ§€ μ•κ³  react-query μΊμ‹λ¥Ό μ”μ²­ν•κ² λλ‹¤.

ν•μ§€λ§ μΊμ‹κ°€ ν•­μƒ μµμ‹ μƒνƒλ¥Ό λ³΄μ¥ν•  μ μμ§€ μ•κΈ°μ— μƒλ΅μ΄ λ°μ΄ν„°λ΅ μΊμ‹λ¥Ό μ—…λ°μ΄νΈ ν•λ” μ‹κΈ°λ” μ‚¬μ©μμ μ„¤μ •μ— λ”°λΌ μ§€μ •ν•΄μ•Όν•λ‹¤.

```jsx
key: 'post-data',
data: [
	1: {
		title: 'react-query',
		tagLine: 'is good'
	},

	2: {
		title: 'menage state',
		tagLing: 'is hard'
	}
]
```

μ„ μ½”λ“λ” react-query μΊμ‹μ μμ‹μ΄λ‹¤. κ°κ°μ μΊμ‹λ” `key` μ— ν•΄λ‹Ήν•λ” valueλ΅ κ΄€λ¦¬λλ‹¤.

μΊμ‹κ°€ μ„λ²„μ λ°μ΄ν„°μ™€ κ°™μ΄ μµμ‹  μƒνƒλ΅ μ μ§€λκΈ° μ„ν•΄ μ„λ²„μ λ°μ΄ν„°μ™€ μΌμΉν•λ”μ§€ ν™•μΈν•΄μ•Όν•λ”λ° ν¬κ² λ‘κ°€μ§€ λ°©λ²•μ΄ μλ‹¤.

- λ…λ Ήν• μ²λ¦¬ : query ν΄λΌμ΄μ–ΈνΈμ λ°μ΄ν„°λ¥Ό λ¬΄ν¨ν™”ν•κ³  κµμ²΄ν•  μΊμ‹ λ°μ΄ν„°λ¥Ό μ„λ²„μ—μ„ λ¶λ¬μ¨λ‹¤.
- μ„ μ–Έν• μ²λ¦¬ : refetchλ¥Ό νΈλ¦¬κ±°ν•λ” μ΅°κ±΄μ„ κµ¬μ„±ν•΄ λ°μ΄ν„°λ¥Ό κµ¬μ„±ν•λ‹¤. (ex - focus, staleTime λ“±μ κΈ°μ¤€)

## Other

---

μ„λ²„ μƒνƒλ¥Ό κ΄€λ¦¬ν•λ” κΈ°λ¥ μ™Έμ—λ„ react-queryλ” μ„λ²„ μƒνƒ κ΄€λ¦¬λ¥Ό μ„ν• μ—¬λ¬ λ„κµ¬λ¥Ό μ κ³µν•λ‹¤.

### Error state / Loading

- react-queryλ” μ„λ²„μ— λ€ν• λ¨λ“  λ΅λ”© λ° μ¤λ¥ μƒνƒλ¥Ό μ μ§€, κ΄€λ¦¬ν•κΈ° λ•λ¬Έμ— μλ™μΌλ΅ κ΄€λ¦¬ν•  ν•„μ”κ°€ μ—†λ‹¤.

### Pagenation / Infinite scroll

- μ‚¬μ©μλ¥Ό μ„ν• pagenation, λ¬΄ν• μ¤ν¬λ΅¤μ„ μ κ³µν•λ‹¤.

### Prefetch

- μ‚¬μ©μκ°€ λ°μ΄ν„°λ¥Ό ν•„μ”λ΅ν•λ” μ‹μ μ„ νμ•…ν•΄ λ―Έλ¦¬ λ°μ΄ν„°λ¥Ό κ°€μ Έμ™€ μΊμ‹±ν•  μ μλ‹¤. λ―Έλ¦¬ μΊμ‹±λ λ°μ΄ν„°λ”  μ„λ²„μ—μ„ λ‹¤μ‹ κ°€μ Έμ¬ ν•„μ”κ°€ μ—†μΌλ―€λ΅ λ¶ν•„μ”ν• μ„λ²„μ νΈμ¶μ„ μ¤„μΌ μ μλ‹¤.

### Mutations

- λ‹¨μ–΄μ λ»λ€λ΅ μ„λ²„ λ°μ΄ν„°μ λ³€μ΄μ™€ μ—…λ°μ΄νΈλ¥Ό κ΄€λ¦¬ν•  μ μλ‹¤.

### De-duplication of requests

- κ°κ°μ μΏΌλ¦¬κ°€ keyλ΅ μ‹λ³„λκΈ° λ•λ¬Έμ— μ”μ²­μ„ κ΄€λ¦¬ν•  μ μκ³  μ—¬λ¬ μ”μ†μ—μ„ κ°™μ€ λ°μ΄ν„°λ¥Ό μ”μ²­ν•  κ²½μ° ν•λ²μ— μ”μ²­μΌλ΅ μ²λ¦¬ν•  μ μλ‹¤.

### Retry

- μ„λ²„μ—μ„ μ¤λ¥κ°€ λ°μƒν•λ” κ²½μ° μ¬μ‹λ„λ¥Ό κ΄€λ¦¬ν•  μ μλ‹¤.

### Callbacks

- μΏΌλ¦¬ μ”μ²­μ μ„±κ³µ, μ¤λ¥λ¥Ό κµ¬λ³„ν•΄ μ΅°μΉλ¥Ό μ·¨ν•  μ μλ„λ΅ μ½λ°±μ„ μ „λ‹¬ν•  μ μλ‹¤.

---
<br><br>
## λ§λ¬΄λ¦¬
pre projectλ¥Ό μ§„ν–‰ν•λ©΄μ„ TILμ„ λ„λ¬΄ μ†ν™€ν ν•κ³  μμ—λ‹¤...
μ„λ²„ λ°μ΄ν„°μ μƒνƒ κ΄€λ¦¬μ— λ€ν•΄ κ³ λ―Όν•λ‹¤ React Queryλ¥Ό μ•κ²λμ—λ”λ° μ•„μ§ κΈ°μ΅΄μ λ°©μ‹κ³Ό μ°¨μ΄λ¥Ό λλ‚„ μ μ—†μ–΄ λ§μ€ λ νΌλ°μ¤μ™€ ν•™μµμ΄ ν•„μ”ν•λ‹¤.

